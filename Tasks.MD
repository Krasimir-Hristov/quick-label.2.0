
Този документ описва задачите за разработка на уеб приложение за генериране на етикети от Excel файл, базирано на предоставен дизайн.

## Фаза 1: Основи и обработка на данни
*Цел: Да се изгради основата за четене на Excel файла и да се обработят **точните колони** (`Artikelbezeichnung` и `Verkaufspreis Kölle-Zoo`) в правилния формат.*

*   [x] **Промпт 1.1: Почистване на началната страница**
*   [x] **Промпт 1.2: Създаване на UI за качване**
*   [x] **Промпт 1.3: Имплементиране на логиката за четене**
*   [x] **Промпт 1.4: Дефиниране на структурата на данните (Interface)**
*   [x] **Промпт 1.5: Създаване на функция за парсване на данните**

## Фаза 2: Визуализация на етикетите
*Цел: Да се пресъздаде **точният визуален дизайн** на жълтия етикет и да се подредят етикетите в решетка по 4 на ред.*

*   [x] **Промпт 2.1: Създаване на компонент за етикет**
*   [x] **Промпт 2.2: Създаване на контейнер за преглед на етикети**
*   [x] **Промпт 2.3: Свързване на компонентите**

## Фаза 3: Принтиране и Сваляне като PDF
*Цел: Да се добави финалната функционалност за принтиране на етикетите и за свалянето им като PDF файл.*

*   [X] **Промпт 3.1: Интеграция на `react-to-print`**
    *   [X] В `app/page.tsx`, добави `useRef` към контейнера, който обвива `<LabelPreview />`.
    *   [X] Добави нов бутон **"Принтирай етикети"**.
    *   [X] Използвай `useReactToPrint` hook, за да задействаш функцията за принтиране при клик на бутона.
*   [X] **Промпт 3.2: Добавяне на стилове за печат/PDF**
    *   [X] В `LabelPreview.tsx`, добави `print:gap-0` на `div`-a с решетката, за да премахнеш разстоянието само при печат.
    *   [X] В `app/page.tsx` или `globals.css`, добави `@media print` стилове.
    *   [X] В тези стилове, **скрий** всички ненужни елементи (заглавие, `FileUpload` компонента, бутоните за принтиране и т.н.) с `display: none !important;`.
    *   [X] В същите стилове, премахни фона и рамките на контейнера на `LabelPreview` (листа хартия), така че да остане само съдържанието.
*   [X] **Промпт 3.3: Добавяне на бутон за сваляне на PDF**
    *   [X] Добави втори бутон **"Свали като PDF"** до бутона за принтиране.
    *   [X] Направи така, че този бутон да извиква **същата функция за принтиране** от `useReactToPrint`, която използва и бутонът "Принтирай".
    *   [?] По желание, добави малък помощен текст под бутоните, който уведомява потребителя: `<p className="text-sm text-gray-500">За да свалите като PDF, изберете 'Save as PDF' от диалоговия прозорец.</p>`.

## Фаза 4: Подобрения и финализиране

*Цел: Да се направи приложението по-устойчиво и лесно за ползване чрез добавяне на обратна връзка за потребителя.*

*   [X] **Промпт 4.1: Обработка на грешки при качване и парсване**
    *   [X] В `FileUpload.tsx`, създай ново състояние за грешки: `const [error, setError] = useState<string | null>(null);`.
    *   [X] В началото на `handleUpload` функцията, изчиствай старата грешка със `setError(null)`.
    *   [X] Добави проверка за типа на файла. Ако не е `.xlsx` или `.xls`, извикай `setError("Моля, изберете валиден Excel файл (.xlsx или .xls).")` и прекрати изпълнението.
    *   [X] Обгради съществуващата логика в `reader.onload` с `try...catch` блок.
    *   [X] В `catch` блока, задай съобщение за грешка, напр. `setError("Възникна грешка при обработката на файла. Проверете структурата му.")`.
    *   [X] В JSX-а на `FileUpload.tsx`, добави условно рендиране на `Alert` или `AlertDestructive` компонент от `shadcn/ui`, който да се показва само когато `error` има стойност.

*   [X] **Промпт 4.2: Добавяне на индикатор за зареждане**
    *   [X] В `FileUpload.tsx`, създай ново състояние за зареждане: `const [isLoading, setIsLoading] = useState(false);`.
    *   [X] В началото на `handleUpload` функцията, задай `setIsLoading(true)`.
    *   [X] В `reader.onload`, използвай `finally` блок (след `try...catch`), за да зададеш `setIsLoading(false)` **винаги** след края на операцията, независимо дали е успешна или не.
    *   [X] Промени бутона "Качи файл", така че да е деактивиран, докато трае зареждането: `disabled={!selectedFile || isLoading}`.
    *   [X] Добави икона (напр. `Loader2` от `lucide-react` с клас `animate-spin`) вътре в бутона, която да се показва условно, само когато `isLoading` е `true`.

*   [ ] **Промпт 4.3: Добавяне на функционалност за изчистване**
    *   [ ] В `app/page.tsx`, създай нова функция `handleClear()`, която извиква `setLabelData([])`.
    *   [ ] Създай нов бутон "Изчисти всичко" (вероятно до бутоните за принтиране).
    *   [ ] Направи така, че този бутон да се показва условно, само когато има генерирани етикети (`labelData.length > 0`).
    *   [ ] Подавай `onClick={handleClear}` на новия бутон.